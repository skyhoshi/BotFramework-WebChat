(this["webpackJsonpsample-customization-smart-display"]=this["webpackJsonpsample-customization-smart-display"]||[]).push([[0],{1033:function(e,t){},1034:function(e,t){},143:function(e,t){},1730:function(e,t){},1783:function(e,t){},1785:function(e,t){},1790:function(e,t){},1791:function(e,t){},1792:function(e,t){},1793:function(e,t){},1797:function(e,t){},1933:function(e,t){},1948:function(e,t,n){},1949:function(e,t,n){},1984:function(e,t,n){},1985:function(e,t,n){},1986:function(e,t,n){},1987:function(e,t,n){},1989:function(e,t,n){"use strict";n.r(t);n(820),n(821),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var a,c=n(29),o=n.n(c),r=n(120),i=n(46),s=n(52),u=n(1),l=n.n(u),p=0;function m(){return f.apply(this,arguments)}function f(){return(f=Object(r.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Date.now(),(!a||t-p>3e5)&&(a=fetch("https://webchat-mockbot-streaming.azurewebsites.net/speechservices/token",{method:"POST"}).then((function(e){return e.json()})).then((function(e){var t=e.region;return{authorizationToken:e.token,region:t}})).catch((function(){p=0})),p=t),e.abrupt("return",a);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var h=m,v=(n(1948),n(12)),d=n.n(v),b=s.hooks.useSendBoxSpeechInterimsVisible,k=function(){var e=b(),t=Object(i.a)(e,1)[0];return l.a.createElement("div",{className:d()("App-BlurLens",{hide:!t})})},j=(n(1949),n(813)),E=n.n(j),O=s.hooks.useActivities;function w(){var e=O();return[Object(i.a)(e,1)[0].slice().reverse().find((function(e){var t=e.from.role,n=e.type;return"bot"===t&&"message"===n}))]}var A=s.Components.SpeakActivity,S=s.hooks.useSendBoxSpeechInterimsVisible,y=function(e){var t=e.lastReadActivityID,n=S(),a=Object(i.a)(n,1)[0],c=w(),o=Object(i.a)(c,1)[0],r=Object(u.useMemo)((function(){return Object(s.createAdaptiveCardsAttachmentMiddleware)()()((function(){return!1}))}),[]);return!a&&!!o&&o.id!==t&&l.a.createElement("div",{className:"App-BotResponse"},!!o.text&&l.a.createElement("div",{className:"App-BotResponse-Activity"},o.text),l.a.createElement(E.a,{className:"App-BotResponse-Attachments",showScrollBar:!1},(o.attachments||[]).map((function(e,t){return l.a.createElement("div",{className:"App-BotResponse-Attachment",key:t},r({activity:o,attachment:e}))}))),o.channelData&&o.channelData.speak&&l.a.createElement(A,{activity:o}))},I=(n(1984),n(1985),function(e){var t=e.children,n=e.icon;return l.a.createElement("div",{className:"App-Notification"},l.a.createElement("i",{className:d()("App-Notification-Icon","ms-Icon","ms-Icon--".concat(n))}),l.a.createElement("div",{className:"App-Notification-Text"},t))});var N=function(){var e=Object(u.useState)(Date.now()),t=Object(i.a)(e,2),n=t[0],a=t[1],c=Object(u.useState)(),s=Object(i.a)(c,2),p=s[0],m=s[1];return Object(u.useEffect)((function(){Object(r.a)(o.a.mark((function e(){var t,n,a,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.weather.gov/gridpoints/SEW/130,67/forecast",{headers:{accept:"application/geo+json"}});case 2:if(!(t=e.sent).ok){e.next=10;break}return e.next=6,t.json();case 6:n=e.sent,a=Object(i.a)(n.properties.periods,1),c=a[0],m(c.temperature);case 10:case"end":return e.stop()}}),e)})))()}),[]),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;Object(u.useEffect)((function(){if(e&&t){var n=setInterval(e,t);return function(){return clearInterval(n)}}}),[e,t])}((function(){return a(Date.now())}),1e3),l.a.createElement("div",{className:"App-Clock"},l.a.createElement("div",{className:"App-Clock-Text"},Intl.DateTimeFormat("en-US",{hour12:!1,timeStyle:"short"}).format(new Date(n))),!!p&&l.a.createElement(I,{icon:"PartlyCloudyDay"},p,"\xb0F"),l.a.createElement(I,{icon:"Mail"},"2"),l.a.createElement(I,{icon:"SkypeForBusinessLogo"},"1"))},x=(n(1986),s.hooks.useMicrophoneButtonClick),B=s.hooks.useMicrophoneButtonDisabled,g=s.hooks.useSendBoxSpeechInterimsVisible,C=function(e){var t=e.onClick,n=g(),a=Object(i.a)(n,1)[0],c=B(),o=Object(i.a)(c,1)[0],r=x(),s=Object(u.useCallback)((function(){r(),t&&t()}),[r,t]);return l.a.createElement("button",{className:d()("App-MicrophoneButton",{dictating:a}),disabled:o,onClick:s},l.a.createElement("i",{className:"ms-Icon ms-Icon--Microphone"}))},D=(n(1987),s.hooks.useDictateInterims),M=s.hooks.useSendBoxSpeechInterimsVisible,R=function(){var e=D(),t=Object(i.a)(e,1)[0],n=M(),a=Object(i.a)(n,1)[0];return a&&l.a.createElement("div",{className:"App-SpeechInterims"},!!a&&t.map((function(e,t){return l.a.createElement("span",{key:t},e,"\xa0")})))},T=function(){var e=w(),t=Object(i.a)(e,1)[0],n=Object(u.useState)(),a=Object(i.a)(n,2),c=a[0],o=a[1],r=Object(u.useCallback)((function(){t&&o(t.id)}),[t,o]);return l.a.createElement("div",{className:"App-SmartDisplay"},l.a.createElement(N,null),l.a.createElement(k,null),l.a.createElement(R,null),l.a.createElement(y,{lastReadActivityID:c}),l.a.createElement(C,{onClick:r}))},z=s.Components.Composer,V=function(){var e=Object(u.useState)(),t=Object(i.a)(e,2),n=t[0],a=t[1];return Object(u.useEffect)((function(){Object(r.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=a,e.next=3,Object(s.createDirectLineSpeechAdapters)({fetchCredentials:h});case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)})))()}),[a]),!!n&&l.a.createElement(z,n,l.a.createElement(T,null))},F=n(138);n.n(F).a.render(l.a.createElement(V,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},210:function(e,t){},806:function(e,t){},808:function(e,t){},809:function(e,t){},810:function(e,t){},811:function(e,t){},812:function(e,t){},819:function(e,t,n){e.exports=n(1989)},820:function(e,t,n){},821:function(e,t,n){},981:function(e,t){},983:function(e,t){}},[[819,1,2]]]);
//# sourceMappingURL=main.fbe2b0ee.chunk.js.map