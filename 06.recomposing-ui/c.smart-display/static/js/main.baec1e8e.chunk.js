(this["webpackJsonpsample-customization-smart-display"]=this["webpackJsonpsample-customization-smart-display"]||[]).push([[0],{1e3:function(e,t){},1035:function(e,t){},1036:function(e,t){},1042:function(e,t){},152:function(e,t){},1766:function(e,t){},1810:function(e,t){},1831:function(e,t){},1833:function(e,t){},1838:function(e,t){},1839:function(e,t){},1840:function(e,t){},1841:function(e,t){},1842:function(e,t){},1846:function(e,t){},1980:function(e,t){},1995:function(e,t,n){},1996:function(e,t,n){},2031:function(e,t,n){},2032:function(e,t,n){},2033:function(e,t,n){},2034:function(e,t,n){},2036:function(e,t,n){"use strict";n.r(t);n(834),n(835),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var a,c=n(3),o=n.n(c),r=n(125),i=n(48),s=n(52),u=n(1),l=n.n(u),f=0;function p(){return m.apply(this,arguments)}function m(){return(m=Object(r.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Date.now(),(!a||t-f>3e5)&&(a=fetch("https://webchat-mockbot-streaming.azurewebsites.net/speechservices/token",{method:"POST"}).then((function(e){return e.json()})).then((function(e){var t=e.region;return{authorizationToken:e.token,region:t}})).catch((function(){f=0})),f=t),e.abrupt("return",a);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var h=p,v=(n(1995),n(13)),d=n.n(v),b=s.hooks.useSendBoxSpeechInterimsVisible,k=function(){var e=b(),t=Object(i.a)(e,1)[0];return l.a.createElement("div",{className:d()("App-BlurLens",{hide:!t})})},j=(n(1996),n(823)),E=n.n(j),O=s.hooks.useActivities;function w(){var e=O();return[Object(i.a)(e,1)[0].slice().reverse().find((function(e){var t=e.from.role,n=e.type;return"bot"===t&&"message"===n}))]}var A=s.Components.SpeakActivity,S=s.hooks.useSendBoxSpeechInterimsVisible,y=function(e){var t=e.lastReadActivityID,n=S(),a=Object(i.a)(n,1)[0],c=w(),o=Object(i.a)(c,1)[0],r=Object(u.useMemo)((function(){return Object(s.createAdaptiveCardsAttachmentMiddleware)()()((function(){return!1}))}),[]);return!a&&!!o&&o.id!==t&&l.a.createElement("div",{className:"App-BotResponse"},!!o.text&&l.a.createElement("div",{className:"App-BotResponse-Activity"},o.text),l.a.createElement(E.a,{className:"App-BotResponse-Attachments",showScrollBar:!1},(o.attachments||[]).map((function(e,t){return l.a.createElement("div",{className:"App-BotResponse-Attachment",key:t},r({activity:o,attachment:e}))}))),o.channelData&&o.channelData.speak&&l.a.createElement(A,{activity:o}))},I=(n(2031),n(2032),function(e){var t=e.children,n=e.icon;return l.a.createElement("div",{className:"App-Notification"},l.a.createElement("i",{className:d()("App-Notification-Icon","ms-Icon","ms-Icon--".concat(n))}),l.a.createElement("div",{className:"App-Notification-Text"},t))});var N=function(){var e=Object(u.useState)(Date.now()),t=Object(i.a)(e,2),n=t[0],a=t[1],c=Object(u.useState)(),s=Object(i.a)(c,2),f=s[0],p=s[1];return Object(u.useEffect)((function(){Object(r.a)(o.a.mark((function e(){var t,n,a,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.weather.gov/gridpoints/SEW/130,67/forecast",{headers:{accept:"application/geo+json"}});case 2:if(!(t=e.sent).ok){e.next=10;break}return e.next=6,t.json();case 6:n=e.sent,a=Object(i.a)(n.properties.periods,1),c=a[0],p(c.temperature);case 10:case"end":return e.stop()}}),e)})))()}),[]),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;Object(u.useEffect)((function(){if(e&&t){var n=setInterval(e,t);return function(){return clearInterval(n)}}}),[e,t])}((function(){return a(Date.now())}),1e3),l.a.createElement("div",{className:"App-Clock"},l.a.createElement("div",{className:"App-Clock-Text"},Intl.DateTimeFormat("en-US",{hour12:!1,timeStyle:"short"}).format(new Date(n))),!!f&&l.a.createElement(I,{icon:"PartlyCloudyDay"},f,"\xb0F"),l.a.createElement(I,{icon:"Mail"},"2"),l.a.createElement(I,{icon:"SkypeForBusinessLogo"},"1"))},x=(n(2033),s.hooks.useMicrophoneButtonClick),B=s.hooks.useMicrophoneButtonDisabled,g=s.hooks.useSendBoxSpeechInterimsVisible,C=function(e){var t=e.onClick,n=g(),a=Object(i.a)(n,1)[0],c=B(),o=Object(i.a)(c,1)[0],r=x(),s=Object(u.useCallback)((function(){r(),t&&t()}),[r,t]);return l.a.createElement("button",{className:d()("App-MicrophoneButton",{dictating:a}),disabled:o,onClick:s},l.a.createElement("i",{className:"ms-Icon ms-Icon--Microphone"}))},D=(n(2034),s.hooks.useDictateInterims),M=s.hooks.useSendBoxSpeechInterimsVisible,R=function(){var e=D(),t=Object(i.a)(e,1)[0],n=M(),a=Object(i.a)(n,1)[0];return a&&l.a.createElement("div",{className:"App-SpeechInterims"},!!a&&t.map((function(e,t){return l.a.createElement("span",{key:t},e,"\xa0")})))},T=function(){var e=w(),t=Object(i.a)(e,1)[0],n=Object(u.useState)(),a=Object(i.a)(n,2),c=a[0],o=a[1],r=Object(u.useCallback)((function(){t&&o(t.id)}),[t,o]);return l.a.createElement("div",{className:"App-SmartDisplay"},l.a.createElement(N,null),l.a.createElement(k,null),l.a.createElement(R,null),l.a.createElement(y,{lastReadActivityID:c}),l.a.createElement(C,{onClick:r}))},z=s.Components.Composer,V=function(){var e=Object(u.useState)(),t=Object(i.a)(e,2),n=t[0],a=t[1];return Object(u.useEffect)((function(){Object(r.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=a,e.next=3,Object(s.createDirectLineSpeechAdapters)({fetchCredentials:h});case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)})))()}),[a]),!!n&&l.a.createElement(z,n,l.a.createElement(T,null))},F=n(143);n.n(F).a.render(l.a.createElement(V,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},217:function(e,t){},814:function(e,t){},816:function(e,t){},817:function(e,t){},818:function(e,t){},819:function(e,t){},820:function(e,t){},821:function(e,t){},822:function(e,t){},833:function(e,t,n){e.exports=n(2036)},834:function(e,t,n){},835:function(e,t,n){},998:function(e,t){}},[[833,1,2]]]);
//# sourceMappingURL=main.baec1e8e.chunk.js.map