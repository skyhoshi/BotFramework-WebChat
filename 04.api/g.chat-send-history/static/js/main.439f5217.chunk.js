(this["webpackJsonpsample-chat-send-history"]=this["webpackJsonpsample-chat-send-history"]||[]).push([[0],{1002:function(t,e){},1003:function(t,e){},132:function(t,e){},1683:function(t,e){},1736:function(t,e){},1738:function(t,e){},1743:function(t,e){},1744:function(t,e){},1745:function(t,e){},1746:function(t,e){},1750:function(t,e){},1864:function(t,e,n){"use strict";n.r(e);var i=n(2),s=n.n(i),r=n(185),a=n.n(r),o=(n(786),n(0)),c=n(1),u=n(4),h=n(5),f=n(187),l=n.n(f),d=function(){function t(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(Object(o.a)(this,t),this._state=[],this._index=-1,this._storageKey="WEBCHAT_SEND_HISTORY",this._persist=e,this._persist){try{this._state=JSON.parse(window.sessionStorage.getItem(this._storageKey))||[]}catch(n){this._state=[]}this.add=this._persistAfter(this.add),this.truncate=this._persistAfter(this.truncate)}}return Object(c.a)(t,[{key:"isActive",value:function(){return this._state.length>0&&this._index>-1}},{key:"add",value:function(t){var e=this._state.indexOf(t);-1!==e&&this._state.splice(e,1),this._state.unshift(t),this._state.length>25&&this.truncate()}},{key:"getNext",value:function(){var t=this._state[this._index+1];if(t)return this._index++,t}},{key:"getPrevious",value:function(){var t=this._state[this._index-1];return t?(this._index--,t):(this.reset(),"")}},{key:"reset",value:function(){this._index=-1}},{key:"truncate",value:function(){this._state.pop()}},{key:"_persistAfter",value:function(t){var e=this;return function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];t.call.apply(t,[e].concat(i)),e._persist&&window.sessionStorage.setItem(e._storageKey,JSON.stringify(e._state))}}}]),t}(),p=n(39),y=n.n(p),_=n(775),v=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(t){var i;return Object(o.a)(this,n),(i=e.call(this,t)).state={directLine:null},i}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.fetchToken()}},{key:"fetchToken",value:function(){var t=Object(_.a)(y.a.mark((function t(){var e,n,i;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://webchat-mockbot.azurewebsites.net/directline/token",{method:"POST"});case 2:return e=t.sent,t.next=5,e.json();case 5:n=t.sent,i=n.token,this.setState((function(){return{directLine:Object(f.createDirectLine)({token:i})}}));case 8:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){return this.state.directLine?s.a.createElement(l.a,Object.assign({className:"chat",directLine:this.state.directLine},this.props)):s.a.createElement("div",null,"Connecting to bot\u2026")}}]),n}(s.a.Component),b=function(t){Object(u.a)(n,t);var e=Object(h.a)(n);function n(){var t;Object(o.a)(this,n);for(var i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];return(t=e.call.apply(e,[this].concat(s))).history=new d,t.state={isDirty:!1},t.store=Object(f.createStore)({},(function(){return function(e){return function(n){return"WEB_CHAT/SEND_MESSAGE"===n.type?t.history.add(n.payload.text):n.fromHistory||"WEB_CHAT/SET_SEND_BOX"!==n.type||(t.setState({isDirty:""!==n.payload.text}),t.history.reset()),e(n)}}})),t.handleKeyDown=function(e){var n=e.target;if(!t.state.isDirty&&"webchat-sendbox-input"===n.dataset.id){var i;switch(e.key){case"ArrowUp":i=t.history.getNext();break;case"ArrowDown":i=t.history.getPrevious();break;default:return}"string"===typeof i&&t.store.dispatch({type:"WEB_CHAT/SET_SEND_BOX",fromHistory:!0,payload:{text:i}})}},t}return Object(c.a)(n,[{key:"render",value:function(){return s.a.createElement("div",{className:"app",onKeyDown:this.handleKeyDown},s.a.createElement(v,{store:this.store}))}}]),n}(s.a.Component);a.a.render(s.a.createElement(b,null),document.getElementById("root"))},191:function(t,e){},768:function(t,e){},770:function(t,e){},771:function(t,e){},772:function(t,e){},773:function(t,e){},774:function(t,e){},781:function(t,e,n){t.exports=n(1864)},786:function(t,e,n){},949:function(t,e){},951:function(t,e){}},[[781,1,2]]]);
//# sourceMappingURL=main.439f5217.chunk.js.map